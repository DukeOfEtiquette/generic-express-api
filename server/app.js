'use strict';

/********************************************************************************
Third Party Libraries
********************************************************************************/
const express = require('express');
const morgan = require('morgan');
const cors = require('cors');


/********************************************************************************
Initialize App
********************************************************************************/
const app = express();


/********************************************************************************
Middleware
********************************************************************************/
app.use(cors());
app.use(morgan(process.env.MORGAN_FORMAT));


/********************************************************************************
Routes
********************************************************************************/
app.use(require('./api/v1.js'));


/********************************************************************************
Errors
********************************************************************************/
app.use(require('./errors/404.js'));
app.use(require('./errors/500.js'));


/********************************************************************************
Export interface
********************************************************************************/
module.exports = {
  expressApp: app,
  start: function(){
    app.listen(process.env.PORT, () => {
      console.log(`Server listening on PORT ${process.env.PORT}`);
    });
  },
};